<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form with JSON Submission</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h2>Submit Your Story</h2>
        <form id="storyForm">
            <div class="mb-3">
                <label for="user_authority" class="form-label">User Authority</label>
                <input type="text" class="form-control" name="user_authority" id="user_authority" value="9012">
            </div>
            <div class="mb-3">
                <label for="story_id" class="form-label">Story ID</label>
                <input type="text" class="form-control" name="story_id" id="story_id" value="561">
            </div>
            <div class="mb-3">
                <label for="chapter_id" class="form-label">Chapter ID</label>
                <input type="text" class="form-control" name="chapter_id" id="chapter_id" value="132">
            </div>
            <div class="mb-3">
                <label for="chapter_title" class="form-label">Chapter Title</label>
                <input type="text" class="form-control" name="chapter_title" id="chapter_title" value="The Three Little Pigs">
            </div>
            <div class="mb-3">
                <label for="chapter_content" class="form-label">Chapter Content</label>
                <textarea class="form-control" name="chapter_content" id="chapter_content" rows="4">[
                    "Once upon a time there was an old mother pig who had three little pigs and not enough food to feed them. So when they were old enough, she sent them out into the world to seek their fortunes.",
                    "The first little pig was very lazy. He didn't want to work at all and he built his house out of straw. The second little pig worked a little bit harder but he was somewhat lazy too and he built his house out of sticks. Then, they sang and danced and played together the rest of the day.",
                    "The third little pig worked hard all day and built his house with bricks. It was a sturdy house complete with a fine fireplace and chimney. It looked like it could withstand the strongest winds."
                ]</textarea>
            </div>
            <div class="mb-3">
                <label for="narrate_mode" class="form-label">Narrate Mode</label>
                <input type="text" class="form-control" name="narrate_mode" id="narrate_mode" value="free">
            </div>
            <div class="mb-3">
                <label for="narrate_lang" class="form-label">Narrate Language</label>
                <input type="text" class="form-control" name="narrate_lang" id="narrate_lang" value="en">
            </div>
            <div class="mb-3">
                <label for="scene_mode" class="form-label">Scene Mode</label>
                <input type="text" class="form-control" name="scene_mode" id="scene_mode" value="null">
            </div>
            <div class="mb-3">
                <label for="scene_model" class="form-label">Scene Model</label>
                <input type="text" class="form-control" name="scene_model" id="scene_model" value="dall-e-3">
            </div>
            <div class="mb-3">
                <label for="scene_size" class="form-label">Scene Size</label>
                <input type="text" class="form-control" name="scene_size" id="scene_size" value="1024x1024">
            </div>
            <div class="mb-3">
                <label for="overwrite" class="form-label">Overwrite</label>
                <input type="text" class="form-control" name="overwrite" id="overwrite" value="false">
            </div>
            <button type="submit" class="btn btn-primary">Send Data</button>
        </form>
    </div>

    <script>
        document.getElementById('storyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);

            // Converting FormData to JSON
            let object = {};
            formData.forEach((value, key) => {
                // Assuming every value except chapter_content is directly usable
                if (key !== 'chapter_content') {
                    object[key] = value;
                } else {
                    // Parsing the stringified array for chapter_content
                    object[key] = JSON.parse(value);
                }
            });

            axios.post('http://localhost:9111/api/story/chapter/create', object, {
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(function (response) {
                console.log('Response:', response);
            })
            .catch(function (error) {
                console.error('Error:', error);
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
